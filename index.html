<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>CS:GO - eDPI Calculator</title>
    <link rel="icon" href="favicon.png">
    <!-- Import Google Icon Font -->
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <!-- Import materialize.css-->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/0.98.2/css/materialize.min.css">
    <!-- Let browser know website is optimized for mobile -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>

    <link rel="stylesheet" href="css/style.css">
  </head>
  <body>
    <a href="https://github.com/Delivator/csgo-edpi-calculator"><img style="position: fixed; top: 40px; right: -40px; border: 0; z-index: 100; transform: rotate(45deg);" src="https://i.imgur.com/J1LHJbb.png" alt="Fork me on GitHub" data-canonical-src="https://s3.amazonaws.com/github/ribbons/forkme_right_darkblue_121621.png"></a>
    <div class="container" id="main" style="margin-top: 80.5px;">
      <div class="row">
        <div class="col l6 offset-l3 m8 offset-m2 s12">
          <div class="card">
            <div class="teal card-content white-text">
              <span class="card-title">eDPI Calculator</span>
            </div>
            <div class="card-tabs">
              <ul class="tabs tabs-fixed-width">
                <li class="tab"><a href="#edpi-card">eDPI</a></li>
                <li class="tab"><a href="#sens-card">Sensitivity</a></li>
              </ul>
            </div>
            <div class="card-content">
              <div id="edpi-card">
                <div>
                  <ul class="collapsible" data-collapsible="expandable">
                    <li>
                      <div class="collapsible-header" id="dpi-collapsible"><i class="material-icons tiny">mouse</i> DPI</div>
                      <div class="collapsible-body">
                        <div class="video-container">
                          <div id="video-embed">
                            <img src="https://img.youtube.com/vi/cAEb9a-dltk/mqdefault.jpg" alt="YouTube Video Thumbnail" width="100%">
                          </div>
                        </div>
                      </div>
                    </li>
                  </ul>
                  <div class="input-field">
                    <input id="dpi" type="number" min="0" step="1" class="validate" autocomplete="off">
                    <label for="dpi">DPI: e.g. 400</label>
                  </div>
                </div>
                <div>
                  <ul class="collapsible" data-collapsible="expandable">
                    <li>
                      <div class="collapsible-header"><i class="material-icons tiny">gps_fixed</i> Sensitivity</div>
                      <div class="collapsible-body">
                        <span>Your Sensitivity can be found and changed by typing "sensitivity" into your developer console:</span>
                        <img class="responsive-img" src="https://i.imgur.com/iMFltgF.png" alt="CS:GO Console Screenshot" width="100%">
                      </div>
                    </li>
                  </ul>
                  <div class="input-field">
                    <input id="sens" type="number" min="0" step="0.001" class="validate" autocomplete="off">
                    <label for="sens">Sensitivity: e.g. 1.2</label>
                  </div>
                </div>
                <div>
                  <ul class="collapsible" data-collapsible="expandable">
                    <li>
                      <div class="collapsible-header"><i class="material-icons tiny">input</i> Raw Input</div>
                      <div class="collapsible-body">
                        <blockquote cite="https://redd.it/3n3mva">
                          <b>TL;DR:</b> basically, if you have your windows mouse settings at 6/11 and smoothing off raw input will not effect your sensitivity at all. What it will effect are "feel", which honestly might be a placebo. I recommend trying both and just using what you feel best from a blind test (have someone else change the settings for you and don't look at them)
                        </blockquote>
                        <i>/u/pwnify (<a href="https://redd.it/3n3mva" target="_blank">https://redd.it/3n3mva</a>)</i><br>
                        <hr>
                        <span>Can be changed by typing <code class="grey lighten-3">m_rawinput "1"</code> into your developer console. 0 = off; 1 = on.</span>
                      </div>
                    </li>
                  </ul>
                  <div class="switch">
                    <label>
                      m_rawinput 0
                      <input type="checkbox" id="raw-input">
                      <span class="lever"></span>
                      m_rawinput 1
                    </label>
                  </div>
                </div>
                <div style="margin-top: 20px;" id="win-sense-col">
                  <ul class="collapsible" data-collapsible="expandable">
                    <li>
                      <div class="collapsible-header"><i class="material-icons tiny">desktop_windows</i> Windows sensitivity</div>
                      <div class="collapsible-body">
                        <span>Can be found and changed by pressing <code class="grey lighten-3">Windows + R</code> and typing <code class="grey lighten-3">main.cpl</code>. On the 3rd tab you can find the pointer speed slider.</span>
                      </div>
                    </li>
                  </ul>
                  <div>
                    <p class="range-field">
                      <input type="range" id="win-sens" min="1" max="11" />
                    </p>
                  </div>
                </div>
                <blockquote class="blue-grey lighten-5" style="font-size: 150%;"><span id="edpi" class="grey-text">480</span> eDPI</blockquote>
              </div>
              <div id="sens-card">
                <div>
                  <ul class="collapsible" data-collapsible="expandable">
                    <li>
                      <div class="collapsible-header" id="dpi-collapsible2"><i class="material-icons tiny">mouse</i> DPI</div>
                      <div class="collapsible-body">
                        <div class="video-container">
                          <div id="video-embed2">
                            <img src="https://img.youtube.com/vi/cAEb9a-dltk/mqdefault.jpg" alt="YouTube Video Thumbnail" width="100%">
                          </div>
                        </div>
                      </div>
                    </li>
                  </ul>
                  <div class="input-field">
                    <input id="dpi2" type="number" min="0" step="1" class="validate" autocomplete="off">
                    <label for="dpi">DPI: e.g. 400</label>
                  </div>
                </div>
                <div>
                  <ul class="collapsible" data-collapsible="expandable">
                    <li>
                      <div class="collapsible-header"><i class="material-icons tiny">settings</i> eDPI</div>
                      <div class="collapsible-body">
                        <span>eDPI stands for Effective DPI. This number describes your "real" sensitivity. I don't fucking know how to descibe it ok?</span>
                      </div>
                    </li>
                  </ul>
                  <div class="input-field">
                    <input id="edpi2" type="number" min="0" step="0.001" class="validate" autocomplete="off">
                    <label for="sens">eDPI: e.g. 480</label>
                  </div>
                </div>
                <blockquote class="blue-grey lighten-5" style="font-size: 150%;"><span id="sens2" class="grey-text">1.2</span> Sensitivity</blockquote>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/0.98.2/js/materialize.min.js"></script>
    <script type="text/javascript">
    $(document).ready(function() {
      // Update margin functions
      function calcMargin() {
        var windowHeight = $(window).height();
        var containerHeight = $("#main").height();
        var margin = (windowHeight - containerHeight) / 2;
        if (margin <= 0) {
          margin = 0;
        }
        return margin;
      }

      function updateMargin(margin) {
        $("#main").css("margin-top", margin);
      }

      // Update margin function, but slower
      function slowUpdateMargin() {
        function forLoop(i) {
          if (i < 0) return;
          setTimeout(function () {
            updateMargin(calcMargin());
            forLoop(--i);
          }, 5)
        }
        forLoop(50);
      }

      // Update margin after load
      updateMargin(calcMargin());

      // Update margin on window resize
      $(window).resize(function() {
        updateMargin(calcMargin());
      });

      // Update margin on different elements
      $(".collapsible").click(function() {
        setTimeout(function () {
          updateMargin(calcMargin());
        }, 250);
      });

      $(".tab").click(function() {
        setTimeout(function() {
          updateMargin(calcMargin());
        }, 5);
      });

      $("#dpi-collapsible").click(function() {
        if ($("#video-embed").html().trim().startsWith('<img')) {
          $("#video-embed").html('<iframe width="560" height="315" src="https://www.youtube.com/embed/cAEb9a-dltk?rel=0&autoplay=1" frameborder="0" allowfullscreen></iframe>');
        } else {
          $("#video-embed").html('<img src="https://img.youtube.com/vi/cAEb9a-dltk/mqdefault.jpg" alt="YouTube Video Thumbnail" width="100%">');
        }
      });

      $("#dpi-collapsible2").click(function() {
        if ($("#video-embed2").html().trim().startsWith('<img')) {
          $("#video-embed2").html('<iframe width="560" height="315" src="https://www.youtube.com/embed/cAEb9a-dltk?rel=0&autoplay=1" frameborder="0" allowfullscreen></iframe>');
        } else {
          $("#video-embed2").html('<img src="https://img.youtube.com/vi/cAEb9a-dltk/mqdefault.jpg" alt="YouTube Video Thumbnail" width="100%">');
        }
      });

      // Switch change trigger
      $("#raw-input").change(function() {
        if (this.checked) {
          $("#win-sense-col").addClass("grey-text");
          $("#win-sens").prop("disabled", true);
        } else {
          $("#win-sense-col").removeClass("grey-text");
          $("#win-sens").prop("disabled", false);
        }
        calcAndUpdateEdpi();
      });

      // Input type trigger
      $("#dpi").keyup(function() {calcAndUpdateEdpi();});
      $("#sens").keyup(function() {calcAndUpdateEdpi();});
      $("#win-sens").change(function() {calcAndUpdateEdpi();});

      $("#dpi2").keyup(function() {calcAndUpdateSens();});
      $("#edpi2").keyup(function() {calcAndUpdateSens();});

      // eDPI calculation function
      function calcEdpi(dpi, sens, win, raw) {
        var edpi = 0,
            winMultiplier = 1.0;

        if (!raw) {
          var multipliers = {1: 0.03, 2: 0.06, 3: 0.25, 4: 0.5, 5: 0.75, 6: 1.0, 7: 1.5, 8: 2.0, 9: 2.5, 10: 3.0, 11: 3.5};
          winMultiplier = multipliers[win];
        } else {
          winMultiplier = 1.0;
        }

        edpi = dpi * sens * winMultiplier;
        return edpi;
      }

      function calcSens(edpi, dpi, win, raw) {
        var sens = 0,
            winMultiplier = 1.0;

        if (!raw) {
          var multipliers = {1: 0.03, 2: 0.06, 3: 0.25, 4: 0.5, 5: 0.75, 6: 1.0, 7: 1.5, 8: 2.0, 9: 2.5, 10: 3.0, 11: 3.5};
          winMultiplier = multipliers[win];
        } else {
          winMultiplier = 1.0;
        }

        sens = edpi / dpi / winMultiplier;
        return sens;
      }

      function calcAndUpdateEdpi() {
        var dpi = $("#dpi").val();
        var sens = $("#sens").val();
        var win_sens = $("#win-sens").val();
        var isRawChecked = $("#raw-input").is(":checked");

        updateEdpi(calcEdpi(dpi, sens, win_sens, isRawChecked));
      }

      function calcAndUpdateSens() {
        let dpi = $("#dpi2").val();
        let edpi = $("#edpi2").val();

        updateSens(calcSens(edpi, dpi, 6, true));
      }

      function updateEdpi(value) {
        var edpi = $("#edpi");
        if (value > 0) {
          edpi.text(value);
          edpi.attr("class", "black-text");
        } else {
          edpi.text("N/A");
          edpi.attr("class", "red-text text-lighten-3");
        }
      }

      function updateSens(value) {
        let sens = $("#sens2");
        if (value > 0) {
          sens.text(value);
          sens.attr("class", "black-text");
        } else {
          sens.text("N/A");
          sens.attr("class", "red-text text-lighten-3");
        }
      }
    });
    </script>
  </body>
</html>
